<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="member">

	<select id="selectMember" parameterType="hashmap" resultType="hashmap">
	
	SELECT MS_NUM,
		   MS_NAME
		   FROM MS_MAININFO
		   WHERE MS_ID = #{id}
		   	 AND MS_PASSWORD  = #{pw}
	
	</select>

	<select id="makeMemNum" resultType="String">
	SELECT LPAD(IFNULL(MAX(ms_num) +1, 1),12, '0') FROM MS_MAININFO
	
	</select>

	<insert id="insertMember" parameterType="hashmap">
		INSERT INTO MS_MAININFO(
			   MS_NUM,
			   MS_ID,
			   MS_PASSWORD,
			   MS_NAME,
			   MS_SEX,
			   MS_BIRTH,
			   MS_FIRST_PHONE1,
			   MS_MID_PHONE1,
			   MS_LAST_PHONE1,
			   SMS_CHK1,
			   MS_BLANK,
			   MS_HOMETEL,
			   MS_HOMEZIP,
			   MS_HOMEADDR1,
			   MS_HOMEADDR2,
			   MS_REGDAY,
			   INPUT_STAFF,
			   INPUT_DATETIME,
			   INPUT_IP,
			   UPDATE_STAFF,
			   UPDATE_DATETIME,
			   UPDATE_IP )       
	  VALUES(
	  			 #{num},
				 #{id},
				 #{pw},
				 #{name},
				 #{sex},
				 #{birth},
				 #{phoneF},
				 hex(aes_encrypt(#{phoneM}, 'JBOG')),
				 #{phoneL},
				 #{smsChk},
				 'Y',
				 hex(aes_encrypt(#{htell}, 'JBOG')),
				 #{hZip},
				 #{hAddrs1},
				 #{hAddrs2},
				 DATE_FORMAT(now(), "%Y%m%d"),
				 DATE_FORMAT(now(), "%m-%d" ),
				 now(),
				 #{mIP},
				 DATE_FORMAT(now(), "%m-%d" ),
				 DATE_FORMAT(now(), "%Y-%m-%d %H:%i:$s"),
				 #{mIP}		   							 			   					
			)	   
		
	</insert>
</mapper>